<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bible Video Library - Home</title>

<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600&family=Inter:wght@400;500&display=swap" rel="stylesheet">

<style>
  * { box-sizing: border-box; }
  body { margin: 0; font-family: 'Inter', sans-serif; background: #f6f4ef; color: #1f1f1f; }
  header { text-align: center; padding: 2rem 1rem; }
  header h1 { font-family: 'Playfair Display', serif; font-size: 2.5rem; margin-bottom: 0.5rem; }
  header p { max-width: 700px; margin: 0 auto; color: #555; font-size: 1rem; }
  nav { display: flex; justify-content: center; gap: 2rem; margin-bottom: 1.5rem; }
  nav a { text-decoration: none; color: #1f1f1f; font-weight: 500; }
  nav a.active { color: #e63946; }

  .calendar-controls { display: flex; justify-content: center; align-items: center; gap: 1rem; margin-bottom: 2rem; }
  .calendar-controls button { padding: 0.5rem 1rem; font-size: 1rem; cursor: pointer; border: 1px solid #ccc; border-radius: 6px; background: #fff; transition: background 0.2s; }
  .calendar-controls button:disabled { opacity: 0.4; cursor: not-allowed; }
  .calendar-controls input[type="date"] { padding: 0.5rem; font-size: 1rem; border-radius: 6px; border: 1px solid #ccc; }

  .video-grid { max-width: 1200px; margin: 0 auto 3rem; display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; }
  .card { background: #fff; border-radius: 12px; overflow: hidden; box-shadow: 0 8px 24px rgba(0,0,0,0.05); cursor: pointer; position: relative; transition: transform 0.2s, box-shadow 0.2s; }
  .card:hover { transform: translateY(-3px); box-shadow: 0 12px 32px rgba(0,0,0,0.08); }
  .card img { width: 100%; display: block; }
  .card-content { padding: 1rem; display: flex; justify-content: space-between; align-items: center; }
  .card-content h3 { margin: 0; font-size: 1rem; flex: 1; }
  .done { font-size: 1.2rem; cursor: pointer; transition: transform 0.2s; }
  .done:hover { transform: scale(1.1); }

  footer { text-align: center; padding: 2rem 1rem; color: #888; font-size: 0.85rem; }

  @media (max-width: 900px) { .video-grid { grid-template-columns: 1fr; } }

  /* Modal */
  .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.75); z-index: 1000; justify-content: center; align-items: center; }
  .modal-content { width: 90%; max-width: 900px; aspect-ratio: 16/9; background: #000; border-radius: 12px; overflow: hidden; position: relative; }
  .modal iframe { width: 100%; height: 100%; }
  .close { position: absolute; top: 10px; right: 14px; color: #fff; font-size: 28px; cursor: pointer; z-index: 1001; }
</style>
</head>
<body>

<header>
  <h1>Bible Video Library</h1>
  <p>Daily devotions and Scripture teaching videos to help you grow in God‚Äôs Word.</p>
  <nav>
    <a href="#" class="active">Home</a>
    <a href="#">Daily Devotions</a>
    <a href="#">1 Timothy 4:13 Project</a>
  </nav>

  <div class="calendar-controls">
    <button id="prevBtn">Prev</button>
    <input type="date" id="datePicker">
    <button id="nextBtn">Next</button>
  </div>
</header>

<main class="video-grid" id="homeVideos">
  <!-- Video cards will appear here -->
</main>

<footer>¬© 2026 Bible Video Library ¬∑ Hosted on GitHub Pages</footer>

<!-- Modal -->
<div id="videoModal" class="modal">
  <div class="modal-content">
    <span class="close">&times;</span>
    <iframe id="videoFrame" allow="autoplay; encrypted-media" allowfullscreen></iframe>
  </div>
</div>

<script>
const API_KEY = "AIzaSyDRd_YN-tjyy1wuDpotgYHoOT9niiOOsEQ"; // Replace with your API Key
const PLAYLISTS = {
  daily: "PLtpb-Y9QLGz5et2tAyq7p0bWnM9Fs82-p",
  timothy: "PLtpb-Y9QLGz7n5-ujPDAfar7P1QIe_vqj"
};

const modal = document.getElementById("videoModal");
const frame = document.getElementById("videoFrame");
document.querySelector('.close').onclick = closeModal;
modal.onclick = e => e.target === modal && closeModal();

function openModal(videoId) {
  frame.src = `https://www.youtube.com/embed/${videoId}?autoplay=1`;
  modal.style.display = 'flex';
}
function closeModal() { frame.src = ''; modal.style.display = 'none'; }

function getStore(key) { return JSON.parse(localStorage.getItem(key)) || []; }
function toggleStore(key, id) {
  const data = getStore(key);
  const index = data.indexOf(id);
  index === -1 ? data.push(id) : data.splice(index, 1);
  localStorage.setItem(key, JSON.stringify(data));
  return data.includes(id);
}

function createVideoCard(container, item) {
  const videoId = item.snippet.resourceId.videoId;
  const title = item.snippet.title;
  const thumb = item.snippet.thumbnails.medium.url;

  const done = getStore('finished');

  const card = document.createElement('div');
  card.className = 'card';
  card.innerHTML = `
    <img src="${thumb}">
    <div class="card-content">
      <h3>${title}</h3>
      <span class="done" title="Mark as finished">${done.includes(videoId) ? '‚ù§Ô∏è' : 'ü§ç'}</span>
    </div>
  `;

  card.onclick = () => openModal(videoId);

  const doneBtn = card.querySelector('.done');
  doneBtn.onclick = e => {
    e.stopPropagation();
    const finished = toggleStore('finished', videoId);
    doneBtn.textContent = finished ? '‚ù§Ô∏è' : 'ü§ç';
  };

  container.appendChild(card);
}

// --------------------
// Home Page Logic
// --------------------
const datePicker = document.getElementById("datePicker");
const prevBtn = document.getElementById("prevBtn");
const nextBtn = document.getElementById("nextBtn");
const container = document.getElementById("homeVideos");

const today = new Date();
const currentYear = today.getFullYear();
const minDate = new Date(currentYear,0,1); // Jan 1
let selectedDate = today;

// Initialize date picker
datePicker.min = minDate.toISOString().split('T')[0];
datePicker.max = today.toISOString().split('T')[0];
datePicker.value = selectedDate.toISOString().split('T')[0];

function updateButtons() {
  prevBtn.disabled = selectedDate <= minDate;
  nextBtn.disabled = selectedDate >= today;
}

// Change date by buttons
prevBtn.onclick = () => { selectedDate.setDate(selectedDate.getDate() -1); datePicker.value = selectedDate.toISOString().split('T')[0]; loadHomeVideos(); }
nextBtn.onclick = () => { selectedDate.setDate(selectedDate.getDate() +1); datePicker.value = selectedDate.toISOString().split('T')[0]; loadHomeVideos(); }

datePicker.onchange = () => {
  selectedDate = new Date(datePicker.value);
  loadHomeVideos();
};

async function loadHomeVideos() {
  container.innerHTML = '';
  updateButtons();

  const month = selectedDate.getMonth();
  const date = selectedDate.getDate();
  const selectedStr = selectedDate.toISOString().split('T')[0];

  let homeVideos = [];

  // 1Ô∏è‚É£ Daily Devotion (current year, selected date)
  let res = await fetch(`https://www.googleapis.com/youtube/v3/playlistItems?part=snippet&maxResults=50&playlistId=${PLAYLISTS.daily}&key=${API_KEY}`);
  let data = await res.json();
  const dailyVideo = data.items.find(item => item.snippet.publishedAt.startsWith(selectedStr));
  if(dailyVideo) homeVideos.push(dailyVideo);

  // 2Ô∏è‚É£ Timothy Project (month/day, 2025 & 2026)
  res = await fetch(`https://www.googleapis.com/youtube/v3/playlistItems?part=snippet&maxResults=50&playlistId=${PLAYLISTS.timothy}&key=${API_KEY}`);
  data = await res.json();
  const timothyMatches = data.items.filter(item => {
    const pub = new Date(item.snippet.publishedAt);
    return pub.getMonth() === month && pub.getDate() === date;
  }).slice(0,2); // take first 2 videos
  homeVideos.push(...timothyMatches);

  if(homeVideos.length === 0) {
    container.innerHTML = "<p>No videos available for this date.</p>";
  } else {
    homeVideos.forEach(video => createVideoCard(container, video));
  }
}

// Initial load
loadHomeVideos();
</script>

</body>
</html>
